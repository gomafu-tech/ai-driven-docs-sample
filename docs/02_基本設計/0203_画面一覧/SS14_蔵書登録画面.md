# SS14: 蔵書登録画面

**アクセス方法**: 書誌登録画面 → 蔵書登録 / スタッフメニュー → 蔵書管理 → 蔵書登録  
**関連業務フロー**: 蔵書管理

## 主要機能
1. **蔵書情報登録**: 個別蔵書の登録処理
2. **バーコード生成**: 蔵書バーコードの自動生成
3. **複数冊登録**: 同一書誌の複数冊一括登録
4. **ラベル印刷**: 蔵書ラベルの印刷

## 入力項目

### 書誌選択
| 項目名 | 項目定義 | 必須 | 追加制約 | 備考 |
|--------|----------|----|---------|----- |
| 書誌ID | 数値 | ● | 既存書誌のみ | 書誌検索で選択 |
| 書名 | 表示項目 | - | - | 選択書誌の書名表示 |
| 著者名 | 表示項目 | - | - | 選択書誌の著者名表示 |

### 蔵書情報
| 項目名 | 項目定義 | 必須 | 追加制約 | 備考 |
|--------|----------|----|---------|----- |
| 資料番号 | 文字列 | ● | 自動生成 | 10桁の番号 |
| バーコード | 文字列 | ● | 自動生成 | バーコード番号 |
| 配架場所 | 選択 | ● | 登録済み場所 | |
| 請求記号 | 文字列 | ● | 最大20文字 | NDC+著者記号 |
| 巻次 | 文字列 | - | 最大10文字 | 全集等の巻数 |

### 受入情報
| 項目名 | 項目定義 | 必須 | 追加制約 | 備考 |
|--------|----------|----|---------|----- |
| 受入日 | 日付 | ● | 本日以前 | デフォルト本日 |
| 受入方法 | 選択 | ● | 購入/寄贈/交換 | |
| 購入価格 | 数値 | - | 0-999999 | 購入時のみ必須 |
| 寄贈者 | 文字列 | - | 最大50文字 | 寄贈時のみ |
| 業者名 | 文字列 | - | 最大50文字 | 購入時推奨 |

### 利用設定
| 項目名 | 項目定義 | 必須 | 追加制約 | 備考 |
|--------|----------|----|---------|----- |
| 利用区分 | 選択 | ● | 貸出可/館内のみ/禁帯出 | |
| 蔵書状態 | 選択 | ● | 正常/整理中/除籍 | デフォルト正常 |
| 特記事項 | [長文テキスト](02_基本設計/0202_項目定義一覧/項目定義一覧.md#長文テキスト) | - | - | |

### 複数冊登録
| 項目名 | 項目定義 | 必須 | 追加制約 | 備考 |
|--------|----------|----|---------|----- |
| 登録冊数 | 数値 | - | 1-50冊 | 複数冊登録時 |
| 巻次開始番号 | 数値 | - | 1-999 | 連続巻次時 |

## 表示項目

### 書誌情報表示
| 項目名 | 表示内容 | 備考 |
|--------|----------|------|
| 書誌ID | 選択された書誌ID | |
| ISBN | ISBNコード | |
| 書名 | 書籍タイトル | |
| 著者名 | 著者名 | |
| 出版社 | 出版社名 | |
| 出版年 | 出版年 | |
| NDC分類 | 分類番号 | 請求記号生成の参考 |

### 生成情報表示
| 項目名 | 表示内容 | 備考 |
|--------|----------|------|
| 次回資料番号 | 自動生成される番号 | |
| 次回バーコード | 自動生成されるバーコード | |
| 推奨請求記号 | 自動生成される請求記号 | 編集可能 |

## 操作機能

### 基本操作
- **書誌検索**: 登録対象書誌の検索・選択
- **登録実行**: 蔵書情報の登録処理
- **複数冊登録**: 同一書誌の複数冊一括登録
- **キャンセル**: 入力を破棄して前画面に戻る

### 補助機能
- **請求記号生成**: NDCと著者記号からの自動生成
- **バーコードプレビュー**: バーコードの表示確認
- **ラベル印刷**: 蔵書ラベルの印刷
- **配架場所管理**: 配架場所の追加・編集

### 連携処理
- **蔵書一覧**: 登録後の蔵書一覧画面へ遷移
- **続けて登録**: 同じ書誌で連続登録

## エラーハンドリング

### 入力エラー
| エラー種別 | 表示メッセージ | 対応 |
|-----------|---------------|-----|
| 書誌未選択 | 「登録する書誌を選択してください」 | 書誌検索促す |
| 必須入力エラー | 「{項目名}を入力してください」 | 該当項目をハイライト |
| 数値範囲エラー | 「{項目名}は{X}～{Y}の範囲で入力してください」 | 範囲表示 |
| 日付エラー | 「受入日は本日以前を指定してください」 | 日付欄をハイライト |

### 業務エラー
| エラー種別 | 表示メッセージ | 対応 |
|-----------|---------------|-----|
| 資料番号重複 | 「この資料番号は既に使用されています」 | 番号再生成 |
| バーコード重複 | 「このバーコードは既に使用されています」 | バーコード再生成 |
| 請求記号重複 | 「同じ請求記号が既に存在します」 | 記号修正促す |
| 配架場所満杯 | 「指定した配架場所の容量が不足しています」 | 他の場所提案 |

### システムエラー
| エラー種別 | 表示メッセージ | 対応 |
|-----------|---------------|-----|
| 番号生成エラー | 「資料番号の生成に失敗しました」 | 再試行促す |
| 印刷エラー | 「ラベルの印刷に失敗しました」 | 印刷設定確認 |
| データベースエラー | 「蔵書情報の保存に失敗しました」 | 再試行促す |