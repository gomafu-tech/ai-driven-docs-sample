# SS16: 蔵書ステータス変更画面

**アクセス方法**: 蔵書一覧画面 → ステータス変更ボタン / 蔵書詳細画面 → ステータス変更  
**関連業務フロー**: 蔵書管理

## 主要機能
1. **蔵書状態変更**: 個別または一括での蔵書状態変更
2. **利用区分変更**: 貸出可否の設定変更
3. **配架場所変更**: 蔵書の配架場所移動
4. **履歴記録**: 変更内容の履歴記録

## 入力項目

### 対象蔵書情報
| 項目名 | 項目定義 | 必須 | 追加制約 | 備考 |
|--------|----------|----|---------|----- |
| 対象資料 | 選択 | ● | 既存資料のみ | 複数選択可 |
| 処理モード | 選択 | ● | 個別/一括 | |

### 変更内容
| 項目名 | 項目定義 | 必須 | 追加制約 | 備考 |
|--------|----------|----|---------|----- |
| 蔵書状態 | 選択 | ● | 正常/整理中/修理中/紛失/除籍 | |
| 利用区分 | 選択 | - | 貸出可/館内のみ/禁帯出 | 状態により制限 |
| 配架場所 | 選択 | - | 登録済み場所 | |
| 変更理由 | 選択 | ● | 定期点検/破損/紛失/その他 | |
| 理由詳細 | [長文テキスト](02_基本設計/0202_項目定義一覧/項目定義一覧.md#長文テキスト) | - | - | その他選択時必須 |

### 処理オプション
| 項目名 | 項目定義 | 必須 | 追加制約 | 備考 |
|--------|----------|----|---------|----- |
| 変更日 | 日付 | ● | 本日以前 | デフォルト本日 |
| 通知設定 | チェックボックス | - | - | 予約者への通知 |
| 一括処理 | チェックボックス | - | - | 同一書誌の全蔵書 |

## 表示項目

### 対象蔵書一覧
| 項目名 | 表示内容 | 備考 |
|--------|----------|------|
| 資料番号 | 10桁の資料番号 | |
| 書名 | 書籍タイトル | |
| 著者名 | 著者名 | |
| 現在状態 | 現在の蔵書状態 | |
| 現在利用区分 | 現在の利用区分 | |
| 配架場所 | 現在の配架場所 | |
| [貸出ステータス](02_基本設計/0202_項目定義一覧/項目定義一覧.md#貸出ステータス) | 貸出中/利用可能等 | |
| 予約数 | 現在の予約件数 | |

### 変更予定内容
| 項目名 | 表示内容 | 備考 |
|--------|----------|------|
| 変更後状態 | 変更予定の状態 | |
| 変更後利用区分 | 変更予定の利用区分 | |
| 変更後配架場所 | 変更予定の配架場所 | |
| 影響する予約 | 影響を受ける予約数 | |

### 変更履歴
| 項目名 | 表示内容 | 備考 |
|--------|----------|------|
| 変更日時 | YYYY/MM/DD HH:MM | |
| 変更前状態 | 変更前の状態 | |
| 変更後状態 | 変更後の状態 | |
| 変更理由 | 変更理由 | |
| 変更者 | 変更したスタッフ | |

## 操作機能

### 基本操作
- **変更実行**: 入力内容での状態変更処理
- **プレビュー**: 変更内容の確認表示
- **キャンセル**: 変更を中止して前画面に戻る
- **一時保存**: 変更内容の一時保存

### 対象選択
- **個別選択**: 特定資料の選択
- **一括選択**: 複数資料の一括選択
- **同一書誌選択**: 同じ書誌の全蔵書選択
- **条件選択**: 検索条件による選択

### 特殊処理
- **除籍処理**: 蔵書の除籍手続き
- **紛失処理**: 紛失時の処理
- **修理中設定**: 修理期間の設定
- **予約キャンセル**: 影響する予約の処理

## エラーハンドリング

### 入力エラー
| エラー種別 | 表示メッセージ | 対応 |
|-----------|---------------|-----|
| 対象未選択 | 「変更対象を選択してください」 | 選択促す |
| 必須入力エラー | 「{項目名}を入力してください」 | 該当項目をハイライト |
| 日付エラー | 「変更日は本日以前を指定してください」 | 日付欄をハイライト |

### 業務エラー
| エラー種別 | 表示メッセージ | 対応 |
|-----------|---------------|-----|
| 貸出中変更不可 | 「貸出中のため状態変更できません」 | 返却促す |
| 予約中変更制限 | 「予約中のため一部変更が制限されます」 | 制限内容表示 |
| 配架場所満杯 | 「指定した配架場所の容量が不足しています」 | 他の場所提案 |
| 除籍条件不適合 | 「除籍条件を満たしていません」 | 条件確認促す |

### システムエラー
| エラー種別 | 表示メッセージ | 対応 |
|-----------|---------------|-----|
| 一括処理失敗 | 「一部の資料の処理に失敗しました」 | 失敗詳細表示 |
| データベースエラー | 「状態変更の保存に失敗しました」 | 再試行促す |
| 通知送信失敗 | 「予約者への通知送信に失敗しました」 | 手動通知促す |

### 権限エラー
| エラー種別 | 表示メッセージ | 対応 |
|-----------|---------------|-----|
| 変更権限なし | 「この資料の状態を変更する権限がありません」 | 権限確認促す |
| 除籍権限なし | 「除籍処理を実行する権限がありません」 | 管理者承認促す |
| 配架場所権限なし | 「この配架場所への移動権限がありません」 | 権限確認促す |