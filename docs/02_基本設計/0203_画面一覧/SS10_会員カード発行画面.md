# SS10: 会員カード発行画面

**アクセス方法**: 会員詳細画面 → カード発行ボタン  
**関連業務フロー**: 会員管理

## 主要機能
1. **カード発行**: 新規会員カードの発行処理
2. **再発行**: 紛失・破損時のカード再発行
3. **カード印刷**: 会員カードの印刷処理
4. **発行履歴記録**: カード発行履歴の記録

## 入力項目

### カード発行情報
| 項目名 | 項目定義 | 必須 | 追加制約 | 備考 |
|--------|----------|----|---------|----- |
| 発行種別 | 選択 | ● | 新規/再発行 | |
| 再発行理由 | 選択 | - | 紛失/破損/その他 | 再発行時のみ |
| 理由詳細 | [長文テキスト](02_基本設計/0202_項目定義一覧/項目定義一覧.md#長文テキスト) | - | - | その他選択時 |
| 発行日 | 日付 | ● | 本日以降 | デフォルト本日 |
| 有効期限 | 日付 | ● | 発行日以降 | 会員有効期限と同じ |

### 印刷設定
| 項目名 | 項目定義 | 必須 | 追加制約 | 備考 |
|--------|----------|----|---------|----- |
| 印刷部数 | 数値 | ● | 1-5部 | デフォルト1部 |
| 印刷プリンタ | 選択 | ● | 利用可能プリンタ | |
| 写真印刷 | チェックボックス | - | - | 写真がある場合のみ |

## 表示項目

### 会員情報
| 項目名 | 表示内容 | 備考 |
|--------|----------|------|
| 会員ID | 会員識別番号 | |
| 氏名・団体名 | 会員名 | |
| [会員種別](02_基本設計/0202_項目定義一覧/項目定義一覧.md#会員種別) | 個人/団体 | |
| 現在の有効期限 | YYYY/MM/DD | |
| 登録日 | YYYY/MM/DD | |

### カード情報
| 項目名 | 表示内容 | 備考 |
|--------|----------|------|
| 現在のカード番号 | 16桁の番号 | 初回発行時は「未発行」 |
| 前回発行日 | YYYY/MM/DD | 初回発行時は「-」 |
| 発行回数 | 回数 | |

### カード発行履歴
| 項目名 | 表示内容 | 備考 |
|--------|----------|------|
| 発行日 | YYYY/MM/DD | |
| 発行種別 | 新規/再発行 | |
| 理由 | 再発行理由 | |
| 発行者 | スタッフ名 | |

## 操作機能

### 基本操作
- **発行実行**: カード発行処理を実行
- **印刷実行**: カードの印刷処理
- **プレビュー**: 印刷前のカードイメージ確認
- **キャンセル**: 処理を中止して前画面に戻る

### 特殊操作
- **旧カード無効化**: 再発行時の旧カード無効化
- **緊急発行**: 即日発行処理
- **発行履歴表示**: 過去の発行履歴一覧

## エラーハンドリング

### 入力エラー
| エラー種別 | 表示メッセージ | 対応 |
|-----------|---------------|-----|
| 必須入力エラー | 「{項目名}を選択してください」 | 該当項目をハイライト |
| 日付エラー | 「有効期限は発行日以降を指定してください」 | 日付欄をハイライト |
| 部数エラー | 「印刷部数は1-5部で指定してください」 | 数値欄をハイライト |

### 業務エラー
| エラー種別 | 表示メッセージ | 対応 |
|-----------|---------------|-----|
| 会員無効 | 「無効な会員のためカード発行できません」 | 会員状態確認促す |
| 有効期限切れ | 「有効期限が切れています。期限延長後に発行してください」 | 期限延長画面へ |
| 印刷エラー | 「印刷に失敗しました。プリンタを確認してください」 | プリンタ状態確認 |

### システムエラー
| エラー種別 | 表示メッセージ | 対応 |
|-----------|---------------|-----|
| カード番号生成エラー | 「カード番号の生成に失敗しました」 | 再試行促す |
| データベースエラー | 「カード情報の保存に失敗しました」 | 再試行促す |